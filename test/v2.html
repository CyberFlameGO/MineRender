<html>
    <body>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r125/three.min.js" integrity="sha512-XI02ivhfmEfnk8CEEnJ92ZS6hOqWoWMKF6pxF/tC/DXBVxDXgs2Kmlc9CHA0Aw2dX03nrr8vF54Z6Mqlkuabkw==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r17/Stats.min.js" integrity="sha512-mfOs9z5Hk96xJH71l0ptzjgGvflNJRnHA7brsEwqDZf7mJa8QDfUtcHICKMXq4Ys80g5HKQMD9rsY3R44ZlEug==" crossorigin="anonymous"></script>

        <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@dev/examples/js/controls/OrbitControls.js"></script>

        <script>
            (function () {
                var script = document.createElement('script');
                script.onload = function () {
                    var stats = new Stats();
                    document.body.appendChild(stats.dom);
                    requestAnimationFrame(function loop() {
                        stats.update();
                        requestAnimationFrame(loop)
                    });
                };
                script.src = 'https://unpkg.com/stats.js/build/stats.min.js';
                document.head.appendChild(script);
            })()
        </script>
        <script src="../dist/bundle.js"></script>
        <script>
            const start = Date.now();

            // var stats = new Stats();
            // stats.showPanel( 0 ); // 0: fps, 1: ms, 2: mb, 3+: custom
            // document.body.appendChild( stats.dom );

            // const MineRender = require("../src");
            const renderer = new MineRender.Renderer();
            document.body.appendChild(renderer.renderer.domElement);

            // let mat = MineRender.Materials.get({
            //     texture: {
            //         src: "http://assets.mojang.com/SkinTemplates/4px_reference.png"
            //     }
            // });
            //
            // let geo1 = MineRender.Geometries.getBox({
            //     width: 8,
            //     height: 8,
            //     depth: 8,
            //     uv: MineRender.UVMapper.facesToUvArray({
            //         west: {
            //             uv: [
            //                 0, 8, 8, 16
            //             ]
            //         },
            //         south: {
            //             uv: [
            //                 8, 8, 16, 16
            //             ]
            //         },
            //         east: {
            //             uv: [
            //                 16, 8, 24, 16
            //             ]
            //         },
            //         north: {
            //             uv: [
            //                 24, 8, 32, 16
            //             ]
            //         },
            //         up: {
            //             uv: [
            //                 8, 0, 16, 8
            //             ]
            //         },
            //         down: {
            //             uv: [
            //                 16, 0, 24, 8
            //             ]
            //         }
            //     },64,64)
            // }).clone();
            //
            // geo1.translate(-1, -1, -1);
            //
            // let geo2 = MineRender.Geometries.getBox({
            //     width: 8,
            //     height: 8,
            //     depth: 8,
            // }).clone();
            // geo2.translate(2, 1, 3);
            //
            // let mergedGeo = MineRender.BufferGeometryUtils.mergeBufferGeometries([geo1, geo2]);
            //
            //
            // let mesh = new THREE.Mesh(mergedGeo, mat);

            // let obj = new MineRender.SkinObject();
            // obj.setSkinTexture("http://assets.mojang.com/SkinTemplates/4px_reference.png")

            MineRender.Models.getMerged({
                assetType: "models",
                type: "block",
                path: "acacia_log",
                extension: ".json"
            }).then(model=>{
                console.log(model)
                let obj = new MineRender.ModelObject(model);
                renderer.scene.add(obj);

                console.log("Time to scene add: " + (Date.now() - start) + "ms");
            })

            // let obj = new MineRender.ModelObject({
            //     "gui_light": "side",
            //     "display": {
            //         "gui": {"rotation": [30, 225, 0], "translation": [0, 0, 0], "scale": [0.625, 0.625, 0.625]},
            //         "ground": {"rotation": [0, 0, 0], "translation": [0, 3, 0], "scale": [0.25, 0.25, 0.25]},
            //         "fixed": {"rotation": [0, 0, 0], "translation": [0, 0, 0], "scale": [0.5, 0.5, 0.5]},
            //         "thirdperson_righthand": {"rotation": [75, 45, 0], "translation": [0, 2.5, 0], "scale": [0.375, 0.375, 0.375]},
            //         "firstperson_righthand": {"rotation": [0, 45, 0], "translation": [0, 0, 0], "scale": [0.4, 0.4, 0.4]},
            //         "firstperson_lefthand": {"rotation": [0, 225, 0], "translation": [0, 0, 0], "scale": [0.4, 0.4, 0.4]}
            //     },
            //     "key": {"namespace": "minecraft", "type": "block", "path": "stone"},
            //     "name": "stone",
            //     "elements": [{"from": [0, 0, 0], "to": [16, 16, 16], "faces": {"down": {"texture": "#down", "cullface": "down"}, "up": {"texture": "#up", "cullface": "up"}, "north": {"texture": "#north", "cullface": "north"}, "south": {"texture": "#south", "cullface": "south"}, "west": {"texture": "#west", "cullface": "west"}, "east": {"texture": "#east", "cullface": "east"}}}],
            //     "textures": {"particle": "#all", "down": "#all", "up": "#all", "north": "#all", "east": "#all", "south": "#all", "west": "#all", "all": "minecraft:block/stone"},
            //     "names": ["block", "cube", "cube_all"]
            // });
            // renderer.scene.add(obj);

            // let wireGeo = new THREE.EdgesGeometry(obj);
            // let wireMat = new THREE.LineBasicMaterial({color: 0xffffff, linewidth: 2})
            // let wireframe = new THREE.LineSegments(wireGeo, wireMat);
            // obj.add(wireframe);

            // setInterval(() => {
            //     renderer.scene.clear();
            // }, 2000);


            renderer.camera.position.set(20, 15, 20);
            renderer.camera.lookAt(new THREE.Vector3(0, 0, 0))

            const controls = new THREE.OrbitControls(renderer.camera, renderer.renderer.domElement);

            controls.update();

            function animate() {

                // stats.begin();

                renderer.renderer.render(renderer.scene, renderer.camera);

                // stats.end();

                requestAnimationFrame(animate);

            }

            animate();
        </script>
    </body>
</html>
